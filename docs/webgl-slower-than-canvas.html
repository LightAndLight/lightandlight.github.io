<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="preload" href="/fonts/SourceSerif4/SourceSerif4-Regular.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/fonts/SourceSans3/SourceSans3-Regular.woff2" as="font" type="font/woff2" crossorigin>

  <link rel="stylesheet" href="/res/fonts.css">
  <link rel="stylesheet" href="/res/style.css">

  <!-- defer non-critical stylesheet -->
  <link href="/res/syntax.css" rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/res/syntax.css"></noscript>

  

  

  

  
  <title>WebGL Slower Than Canvas? - blog.ielliott.io</title>
  

  <link rel="canonical" href="https://blog.ielliott.io/webgl-slower-than-canvas">
<link rel="alternate" type="application/atom+xml" title="blog.ielliott.io" href="/feed.xml">

<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="blog.ielliott.io">
<meta property="og:url" content="https://blog.ielliott.io/webgl-slower-than-canvas">
<meta property="og:title" content="WebGL Slower Than Canvas?">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="WebGL Slower Than Canvas?">


<meta name="author" content="Isaac Elliott">
<meta name="description" content="I've recently been working on web a graphics project
where I played a Canvas API implementation
against a WebGL implementation. When running the app in Firefox on Linux, I was surprised to find that the WebGL version was 10-30% slower
(in frames per second) than the Canvas version.">
<meta property="og:description" content="I've recently been working on web a graphics project
where I played a Canvas API implementation
against a WebGL implementation. When running the app in Firefox on Linux, I was surprised to find that the WebGL version was 10-30% slower
(in frames per second) than the Canvas version.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2021-05-20T00:00+00:00">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline":"WebGL Slower Than Canvas?",
  "author": {
    "@type":"Person",
    "name":"Isaac Elliott"
  },
  "datePublished":"2021-05-20T00:00+00:00",
  "dateModified":"2021-05-20T00:00+00:00",
  "description":"I've recently been working on web a graphics project
where I played a Canvas API implementation
against a WebGL implementation. When running the app in Firefox on Linux, I was surprised to find that the WebGL version was 10-30% slower
(in frames per second) than the Canvas version.",
  "mainEntityOfPage": {
    "@type":"WebPage",
    "@id":"https://blog.ielliott.io/webgl-slower-than-canvas"
  },
  "url": "https://blog.ielliott.io/webgl-slower-than-canvas"
}
</script>
</head>

<body>
  <header>
    <h1><a href="/">I E</a></h1>
    <nav>
      <ol>
        <li><a href="/">Home</a>
        <li><a href="/about">About</a>
        <li><a href="/resources">Resources</a>
      </ol>
    </nav>
  </header>

  <main>
    

    <article>
  <header>
    <h1>WebGL Slower Than Canvas?</h1>
    <p class="post-metadata">
      20 May, 2021
      
      ⋅
      
<a class="post-metadata-tag" href="/tags/programming">programming</a>


      
    </p>
  </header>
  <p>I’ve recently been working on <a href="https://github.com/LightAndLight/rust-wasm-gol/">web a graphics project</a>
where I played a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API">Canvas API</a> implementation
against a <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API">WebGL</a> implementation. When running the app in Firefox on Linux, I was surprised to find that the WebGL version was 10-30% <em>slower</em>
(in frames per second) than the Canvas version.</p>
<p>After much searching I was able to diagnose and fix the problem, which came
down to graphics drivers and browser rendering settings. If your problem is
similar to mine, here’s how you might be able to solve it:</p>
<ol type="1">
<li><p>Check GPU driver status in the browser.</p>
<p>In Firefox, navigate to <code>about:support</code>. <code>Ctrl+F Graphics</code>. Look at the <code>WebGL 1 Driver {Renderer,Version}</code>
rows. If you don’t see your GPU manufacturer and model in these rows, then you need to install
the correct drivers.</p>
<p>For reference, I’m running a Nvidia GeForce RTX2070. Without drivers, my driver renderer was <code>VMware, Inc. -- llvmpipe (LLVM 9.0.1, 256 bits)</code>
and my driver version was <code>3.1 Mesa 20.1.10</code>.</p></li>
<li><p>Install GPU drivers.</p>
<p>I’m on NixOS, so this was as simple as adding</p>
<pre><code>nixpkgs.config.allowUnfree = true;
services.xserver.videoDrivers = [ &quot;nvidia&quot; ];</code></pre>
<p>to my <code>configuration.nix</code>, then running <code>sudo nixos-rebuild switch &amp;&amp; reboot</code>.</p></li>
<li><p>Confirm driver installation.</p>
<p>Repeat step 1. If you still can’t see your GPU manufacturer and model, then I can’t help you.</p>
<p>After step 2, my driver renderer was <code>NVIDIA Corporation -- GeForce RTX 2070/PCIe/SSE2</code> and driver version was
<code>4.6.0 NVIDIA 455.38</code>.</p></li>
<li><p>Enable <a href="https://hacks.mozilla.org/2017/10/the-whole-web-at-maximum-fps-how-webrender-gets-rid-of-jank/">WebRender</a>.</p>
<p>In the Graphics section of <code>about:support</code>, check the <code>Compositing</code> row. If it says <code>WebRender</code>, then you’re
done. If it says <code>Basic</code>, then you need to enable WebRender.</p>
<p>Navigate to <code>about:config</code>, move past the warning, and search for <code>gfx.webrender.enabled</code>. Set it to <code>true</code> and
restart Firefox. Confirm this change by checking <code>Compositing</code> row in <code>about:support</code>.</p></li>
</ol>
<p>Before, each <a href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame">requestAnimationFrame</a> call
lasted 14-15ms in my Canvas implementation, but the app was running well below 60fps. Each frame lasted ~10ms in my WebGL implementation,
but the framerate was even worse than the Canvas version!</p>
<p>After following these instructions, both my Canvas implementation and WebGL implementation run at 60fps. Canvas’ frame
duration didn’t appear to change, but WebGL’s frame duration dropped to ~4ms. Yay!</p>
  <p class="post-navigation">
  
  <a href="/rust-defun-example" title="Previous post: An Example of Defunctionalisation in Rust">← An Example of Defunctionalisation in Rust</a>
  

  
  <a href="/rip-dreamincode" title="Next post: RIP Dream.In.Code">RIP Dream.In.Code →</a>
  
</p>

</article>

  </main>

  <footer>
    <span>Isaac Elliott</span>

    <ol>
      <li><a class="footer-item-link" href="https://github.com/lightandlight">
        <svg class="footer-item-link-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M208.31 75.68A59.78 59.78 0 0 0 202.93 28a8 8 0 0 0-6.93-4 59.75 59.75 0 0 0-48 24h-24a59.75 59.75 0 0 0-48-24 8 8 0 0 0-6.93 4 59.78 59.78 0 0 0-5.38 47.68A58.14 58.14 0 0 0 56 104v8a56.06 56.06 0 0 0 48.44 55.47A39.8 39.8 0 0 0 96 192v8H72a24 24 0 0 1-24-24 40 40 0 0 0-40-40 8 8 0 0 0 0 16 24 24 0 0 1 24 24 40 40 0 0 0 40 40h24v16a8 8 0 0 0 16 0v-40a24 24 0 0 1 48 0v40a8 8 0 0 0 16 0v-40a39.8 39.8 0 0 0-8.44-24.53A56.06 56.06 0 0 0 216 112v-8a58.14 58.14 0 0 0-7.69-28.32M200 112a40 40 0 0 1-40 40h-48a40 40 0 0 1-40-40v-8a41.74 41.74 0 0 1 6.9-22.48 8 8 0 0 0 1.1-7.69 43.8 43.8 0 0 1 .79-33.58 43.88 43.88 0 0 1 32.32 20.06 8 8 0 0 0 6.71 3.69h32.35a8 8 0 0 0 6.74-3.69 43.87 43.87 0 0 1 32.32-20.06 43.8 43.8 0 0 1 .77 33.58 8.09 8.09 0 0 0 1 7.65 41.7 41.7 0 0 1 7 22.52Z"></path></svg>
        GitHub
      </a>

      <li><a class="footer-item-link" href="mailto:blog@id.ielliott.io">
        <svg class="footer-item-link-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M224 48H32a8 8 0 0 0-8 8v136a16 16 0 0 0 16 16h176a16 16 0 0 0 16-16V56a8 8 0 0 0-8-8m-20.57 16L128 133.15 52.57 64ZM216 192H40V74.19l82.59 75.71a8 8 0 0 0 10.82 0L216 74.19z"></path></svg>
        Email
      </a>

      <li><a class="footer-item-link" href="/feed.xml">
        <svg class="footer-item-link-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M224 192a8 8 0 0 1-16 0c0-79.4-64.6-144-144-144a8 8 0 0 1 0-16c88.22 0 160 71.78 160 160M64 104a8 8 0 0 0 0 16 72.08 72.08 0 0 1 72 72 8 8 0 0 0 16 0 88.1 88.1 0 0 0-88-88m4 72a12 12 0 1 0 12 12 12 12 0 0 0-12-12"></path></svg>
        Feed
      </a>
    </ol>
  </footer>

  
</body>

</html>
